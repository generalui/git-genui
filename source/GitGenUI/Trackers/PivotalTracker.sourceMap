{"version":3,"file":"","sourceRoot":"","sources":["./source/GitGenUI/Trackers/PivotalTracker.caf"],"sourceContent":["import &StandardImport, &Config\n\nbaseUrl = :https://www.pivotaltracker.com/services/v5\n\nclass PivotalTracker extends BaseClass\n  @classGetter commonRestOptions: ->\n    normalizedHeaders: X-TrackerToken: config.trackers.pivotalTracker.token\n\n  @getProjects: =>\n    &ArtRestClient.getJson :https://www.pivotaltracker.com/services/v5/projects @commonRestOptions\n\n  @getStories: (projectId, options) ->\n    options extract? states\n    states ?= :started :rejected :planned :unstarted :unscheduled\n    &ArtRestClient.getJson \"#{baseUrl}/projects/#{projectId}/stories?limit=500&date_format=millis&filter=state:#{states.join ','}\" @commonRestOptions\n    .then (stories) ->\n      array {id, requested_by_id, current_state, story_type, name, updated_at, created_at, url, owner_ids} in stories\n        {}\n          id\n          url\n          name\n          requestedById: requested_by_id\n          ownerIds: owner_ids\n          state: current_state\n          updatedAt: updated_at\n          createdAt: created_at\n\n  @getMyAccount: =>\n    &ArtRestClient.getJson :https://www.pivotaltracker.com/services/v5/me?date_format=millis @commonRestOptions\n    .then @_processPivotalTrackerMe\n\n  @getMembers: (projectId) =>\n    &ArtRestClient.getJson \"#{baseUrl}/projects/#{projectId}/memberships\" @commonRestOptions\n    .then (memberships) ->\n      array {person} in memberships\n        {id, name, email} = person\n\n  @openInBrowser: (projectId) ->\n    &open \"\" https://www.pivotaltracker.com/n/projects/#{projectId}\n\n  @_processPivotalTrackerMe: (account) ->\n    merge\n      object v, k from account when k != :api_token && k != :kind with-key lowerCamelCase k\n      tracker: :PivotalTracker\n\n  @authenticate: ({username, password}) ->\n    &ArtRestClient.getJson :https://www.pivotaltracker.com/services/v5/me merge\n      verbose: true\n      headers:\n        Authorization: \"\" Basic #{} &btoa \"#{username}:#{password}\"\n    .then @_processPivotalTrackerMe"],"names":[],"mappings":"AAAA;;+GAAO,8BAAiB,mGAExB,UAAU,gHAEmB,mEAC3B,iBAAY,CAAC,+BAAqB,QAChC,oBAAmB,kBAAgB,+DAErC,MACE,mCAAuB,uDAAqD,2CAE9E,QAAa,CAAC,WAAW,sBAAW,eAClC,sCACA,0BAAM,AAAN,UAAU,WAAS,YAAU,WAAS,aAAW,uBACjD,mCAAsB,gBAAI,kCAAoB,6EAA+D,YAAY,SAAM,6BAC1H,AAAC,CAAC,sBACmG,SAAlG,EAAC,IAAI,iBAAiB,eAAe,YAAY,MAAM,YAAY,YAAY,KAAK,gBAAqB,QAE3G,IACA,KACA,MACA,eAAe,iBACf,UAAU,WACV,OAAO,eACP,WAAW,YACX,WAAW,uCAEnB,MACE,mCAAuB,oEAAkE,6BACnF,kDAER,AAAa,CAAC,cACZ,mDAA0B,kCAAoB,0BAAwB,6BACjE,AAAC,CAAC,0BACa,aAAZ,EAAC,kCAAsB,OAC3B,EAAC,IAAI,MAAM,SAAS,QAApB,6CAEN,QAAgB,CAAC,YAAa,OAC5B,0EAAqD,iDAEvD,QAA2B,CAAC,UAAW,OACrC,iBACmB,eAAV,IAAG,MAAoB,AAAC,AAAD,MAAK,eAAJ,AAAkB,MAAK,cAA/C,IAAG,MAA2D,eAAe,MACpF,SAAS,0CAEb,QAAe,CAAC,CAAC,UAAU,YAAa,OACtC,mCAAuB,iDAA+C,MAAK,CACzE,SAAS,MACT,UACE,qCAA4B,gCAAS,0BAAY,yBAC/C"}