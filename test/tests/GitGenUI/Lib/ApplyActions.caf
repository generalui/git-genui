import &StandardImport

suite: ->
  actions =
    addOne: (a) -> a + 1
    throwError: -> throw new Error :OhNoes!
    double: (a) -> a * 2
    timeout: (a) -> timeout 1 -> a
    div3: (a) -> a / 3

  test "undefined actions" ->
    assert.resolved.eq
      applyActions
        1
        undefined
      result: 1
      actionsApplied: {}

  test "0 actions" ->
    assert.resolved.eq
      applyActions 1, []
      result: 1
      actionsApplied: {}

  test "1 action" ->
    assert.resolved.eq
      applyActions 1,
        [] :addOne
        actions
      result: 2
      actionsApplied: succeeded: [] :addOne

  test "3 actions" ->
    assert.resolved.eq
      applyActions 1,
        :addOne :double :div3
        actions
      result: 4/3
      actionsApplied:  succeeded: :addOne :double :div3

  test "Promise action" ->
    assert.resolved.eq
      applyActions 1,
        [] :timeout
        actions
      result: 1
      actionsApplied: succeeded: [] :timeout

  test "error doesn't stop next action" ->
    assert.resolved.eq
      applyActions
        1
        [] :throwError :double
        actions
        quiet: true
      result: 2
      actionsApplied:
        succeeded: [] :double
        failed:    [] :throwError

